<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Great Expectationsã«ã¤ã„ã¦èª¿ã¹ã¦ã¿ãŸ | -1.9517320122461623</title><meta name=keywords content="GreatExpectations,Python"><meta name=description content="èª¿ã¹ãŸã“ã¨ã¨è©¦ã—ã¦ã¿ãŸã“ã¨ã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã‚ã‚Šã¾ã™ã€‚"><meta name=author content="Me"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.447f4924d3ebf89bcf25c7e77c905cb2ee6ea803dacb2c3621646ef4f50d1f86.css integrity="sha256-RH9JJNPr+JvPJcfnfJBcsu5uqAPayyw2IWRu9PUNH4Y=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://github.com/srn221B/srn221B.github.io/assets/60976262/00ebf8b5-eceb-4f87-8e70-df54f431a9b8><link rel=icon type=image/png sizes=16x16 href=https://github.com/srn221B/srn221B.github.io/assets/60976262/00ebf8b5-eceb-4f87-8e70-df54f431a9b8><link rel=icon type=image/png sizes=32x32 href=https://github.com/srn221B/srn221B.github.io/assets/60976262/00ebf8b5-eceb-4f87-8e70-df54f431a9b8><link rel=apple-touch-icon href=https://user-images.githubusercontent.com/60976262/190914441-404cb19b-540f-4178-a89d-8f89ab1e187c.png><link rel=mask-icon href=https://user-images.githubusercontent.com/60976262/190914441-404cb19b-540f-4178-a89d-8f89ab1e187c.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Great Expectationsã«ã¤ã„ã¦èª¿ã¹ã¦ã¿ãŸ"><meta property="og:description" content="èª¿ã¹ãŸã“ã¨ã¨è©¦ã—ã¦ã¿ãŸã“ã¨ã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã‚ã‚Šã¾ã™ã€‚"><meta property="og:type" content="article"><meta property="og:url" content="https://467tn.com/post/content6/"><meta property="og:image" content="https://user-images.githubusercontent.com/60976262/191047722-dd7ed9ad-6e00-4b50-8073-24ae9602b8d6.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-12-11T11:30:03+00:00"><meta property="article:modified_time" content="2022-12-11T11:30:03+00:00"><meta property="og:site_name" content="467"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://user-images.githubusercontent.com/60976262/191047722-dd7ed9ad-6e00-4b50-8073-24ae9602b8d6.png"><meta name=twitter:title content="Great Expectationsã«ã¤ã„ã¦èª¿ã¹ã¦ã¿ãŸ"><meta name=twitter:description content="èª¿ã¹ãŸã“ã¨ã¨è©¦ã—ã¦ã¿ãŸã“ã¨ã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã‚ã‚Šã¾ã™ã€‚"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://467tn.com/post/"},{"@type":"ListItem","position":3,"name":"Great Expectationsã«ã¤ã„ã¦èª¿ã¹ã¦ã¿ãŸ","item":"https://467tn.com/post/content6/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Great Expectationsã«ã¤ã„ã¦èª¿ã¹ã¦ã¿ãŸ","name":"Great Expectationsã«ã¤ã„ã¦èª¿ã¹ã¦ã¿ãŸ","description":"èª¿ã¹ãŸã“ã¨ã¨è©¦ã—ã¦ã¿ãŸã“ã¨ã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã‚ã‚Šã¾ã™ã€‚","keywords":["GreatExpectations","Python"],"articleBody":"ã“ã®è¨˜äº‹ã¯Qiita x Code Polariså…±å‚¬ï¼å¥³æ€§ITã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒä½œã‚‹ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ Advent Calendar 2022ã®15æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚Qiitaã®ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«å‚åŠ ã™ã‚‹ã®åˆã‚ã¦ã§ã™ï¼ˆwktkï¼‰\næ¦‚è¦ Great Expectations(NOT V2)ã«ã¤ã„ã¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã¿ãªãŒã‚‰ã‚ã‹ã£ãŸã“ã¨ã€è©¦ã—ãŸã“ã¨ã‚’ã¾ã¨ã‚ã‚‹ã€‚\nGreat Expectationsã¨ã¯ ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³(æ¤œè¨¼)ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã€ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°(æ¦‚è¦å®šç¾©)ã‚’ã—ã¦ãã‚Œã‚‹Pythonã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚Superconductiveç¤¾ãŒé–‹ç™ºã—ã¦ã„ã‚‹OSSã€‚GXã¨ç•¥ã•ã‚Œã‚‹ã‚‰ã—ã„ã€‚\nã§ãã‚‹ã“ã¨  ãƒ‡ãƒ¼ã‚¿ã®æœŸå¾…ã®å®šç¾©(Expectation)  oO(xxxã®ã‚«ãƒ©ãƒ ã¯NULLãŒãªã„ã¯ãšã ï¼) oO(yyyã®ã‚«ãƒ©ãƒ ã¯AAã‚‚ã—ãã¯BBã—ã‹å€¤ãŒå…¥ã‚‰ãªã„ã¯ãšã ï¼) ã¨ã„ã£ãŸã‚ˆã†ãªæœŸå¾…ã®å®šç¾©ã€‚   ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•çš„ãªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°(Profiling)  ã€Œxxxã®ã‚«ãƒ©ãƒ ã¯NULLãŒãªã„ã§ã™ã€ ã€Œyyyã®ã‚«ãƒ©ãƒ ã¯AAã‚‚ã—ãã¯BBã—ã‹å€¤ãŒå…¥ã‚‰ãªã„ã§ã™ã€ ã¿ãŸã„ãªãƒ‡ãƒ¼ã‚¿ã®æ¦‚è¦ã®è‡ªå‹•çš„ãªå®šç¾©   ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³(Validation)  å®šç¾©ã—ãŸExpectationãŒæœŸå¾…é€šã‚Šã‹ã®æ¤œè¨¼ã€‚   ãƒ‡ãƒ¼ã‚¿ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–  å®šç¾©ã—ãŸExpectationã‚’Validationã—ãŸçµæœã®ç¢ºèªã€‚   ã•ã¾ã–ã¾ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚„ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ã‹ã‚‰ã®ãƒ­ãƒ¼ãƒ‰  Pandasã‚„Sparkãªã©ã®Dataframeã‚„ã€SQLDatabaseåŠã³ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰    ä½•ãŒå¬‰ã—ã„ã®ã‹ ãƒ‡ãƒ¼ã‚¿ã®å“è³ªç®¡ç†ãŒã§ãã‚‹ -ã€€ãƒã‚°,éå»åˆ†ãƒ‡ãƒ¼ã‚¿ã®ä¿®æ­£ã®æ—©æœŸå¯¾å¿œã€‚\nä¼¼ã¦ã„ã‚‹ã‚‚ã®  dbtã®ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã€‚ kubeflowã®Validationæ©Ÿèƒ½ã€‚  ã§ããªã„ã“ã¨  Pipelineã®å®Ÿè¡Œ  ã‚ãã¾ã§Pythonã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚ ä¾‹ãˆã°ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚’ã—ãŸã„ã¨ãªã£ãŸæ™‚ã€GXã®æ©Ÿèƒ½ã‚’æ´»ã‹ã—ã¦ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã®Pipelineï¼ˆæµã‚Œï¼‰ã‚’ä½œã£ã¦ã„ãã‚ã‘ã ãŒã€ä½œã£ãŸPipelineã®ã‚¹ãƒ†ãƒƒãƒ—æ¯ã®å®Ÿè¡Œã¯ã§ãã‚‹ãŒã€å…¨ä½“ã‚’é€šã—ãŸå®Ÿè¡Œã¯å˜ä½“ã§ã§ããªã„ã€‚ãªã®ã§ã€Airflow,dbt,Prefect,Dagster,Kedroã®ã‚ˆã†ãªDAGã‚’å®Ÿè¡Œã™ã‚‹ãƒ„ãƒ¼ãƒ«ã¨çµ±åˆã™ã‚‹ã¨è‰¯ã„ã€‚ã€€   ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†  ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã™ã‚‹ãªã‚‰DVCã‚„Quikltãªã©ã‚’ä½¿ã†ã¨è‰¯ã„ã€‚   Pythonã®ç’°å¢ƒä»¥å¤–ã§æœ€é©ãªçŠ¶æ…‹ã§å‹•ãã“ã¨  Pythonã§ã§ãã¦ã„ã‚‹ã®ã§ é•ã†è¨€èªã‚„ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰å‘¼ã³å‡ºã™ã¨ãã€CLIã‹ã‚‰å‘¼ã³å‡ºã—ãªã‚“ã¨ã‹ã™ã‚‹ã¨ã„ã†ã“ã¨ã‚‚ã§ãã‚‹ãŒã€è¨€èªã‚„ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã«æ²¿ã£ãŸã‚‚ã®ã‚’é¸æŠã™ã‚‹æ–¹ãŒè‰¯ã„ã€ï¼ˆR-assertR, TensorFlow-TFDVï¼‰    ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ä½œæˆã®æµã‚Œ ã§ã¯ã€GreatExpectationsã‚’ä½¿ç”¨ã—ã¦ä¾‹ãˆã°ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚’ä½œæˆã—ãŸã„ã¨ãªã£ãŸã‚‰ä½•ã‚’ã—ãŸã‚‰è‰¯ã„ã®ã€ã¨ãªã‚‹ã®ã ãŒä»¥ä¸‹ã®ç”»åƒãŒå‚è€ƒã«ãªã‚‹ã€‚  https://docs.greatexpectations.io/assets/images/data_context_does_for_you-df2eca32d0152ead16cccd5d3d226abb.png\n è£œè¶³ã™ã‚‹ã¨\n 1.Setup  ã€ŒDataContextã€ã®ä½œæˆ å¿…è¦ã‚ã‚Œã°ï¼‰æ‹¡å¼µæ©Ÿèƒ½(Plugins)ã®è¨­å®šã‚„Validationçµæœãªã©ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹å ´æ‰€ã®è¨­å®š   2.Connect to Data  ã€ŒDataSourcesã€ã®ä½œæˆ ã€ŒBatchRequestã€/ã€ŒRuntimeBatchRequestã€ã®ä½œæˆ   3.Create Expectations  Profilingã™ã‚‹ãªã©ã‚’ã—ã¦ã€ŒExpectationSuiteã€ã®ä½œæˆ   4.Validate Data  Validatorã‚’ä½¿ç”¨ã—ã¦ã€ä½œæˆã—ãŸã€ŒExpectation Suiteã€ã¨ã€ŒBatchRequestã€ã®ãƒšã‚¢ã®æ¤œè¨¼ CheckPointã‚’ä½¿ç”¨ã—ã¦ã€ä½œæˆã—ãŸã€ŒExpectation Suiteã€ã¨ã€ŒBatchRequestã€ã®ãƒšã‚¢ã‚’è¤‡æ•°ã¾ã¨ã‚ã€æ¤œè¨¼       ç”¨èª ä½•     DataContext ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚ˆã†ãªã‚‚ã®   DataSources æ¤œè¨¼ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã®Connector   BatchRequest DataSourceså†…ã®ã©ã®ãƒ‡ãƒ¼ã‚¿ã‹ã®å®šç¾©(TBLæŒ‡å®š)   RuntimeBatchRequest DataSourceså†…ã®ã©ã®ãƒ‡ãƒ¼ã‚¿ã‹ã®å®šç¾©(QueryæŒ‡å®š)   Expectation ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹æœŸå¾…   ExpectationSuite Expectationã®é›†ã¾ã‚Š    1ã«ã¤ã„ã¦ã¯CLIã‹ã‚‰è¡Œã†ã“ã¨ãŒã§ãã‚‹ 2~4ã«ã¤ã„ã¦ã¯CLIã‚„Python,JupyterNotebookã‹ã‚‰è¡Œã†ã“ã¨ãŒã§ãã‚‹\nè©¦ã—ã¦ã¿ã‚‹ ä¸Šè¨˜ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ä½œæˆã‚’ãªãã£ã¦ã¿ã‚‹ã€‚\n ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦  SQLDBï¼šPostgreSQL   DML  CREATE TABLE sample_poyo ( int_column INTEGER, varchar_column VARCHAR(10), varchar_column2 VARCHAR(10));  DDL  INSERT INTO sample_poyo VALUES (0, 'xxxx', 'zzzz'); INSERT INTO sample_poyo VALUES (1, 'xxxx', 'zzzz'); INSERT INTO sample_poyo VALUES (2, 'xxxx', 'zzzz'); INSERT INTO sample_poyo VALUES (3, 'xxxx', 'zzzz'); INSERT INTO sample_poyo VALUES (4, 'yyyy', 'zzzz'); INSERT INTO sample_poyo VALUES (5, 'yyyy', 'zzzz'); INSERT INTO sample_poyo VALUES (6, 'yyyy', 'zzzz'); INSERT INTO sample_poyo VALUES (7, 'yyyy', 'zzzz');  ãƒ‡ãƒ¼ã‚¿å†…å®¹   int_column | varchar_column | varchar_column2 ------------+----------------+----------------- 0 | xxxx | zzzz 1 | xxxx | zzzz 2 | xxxx | zzzz 3 | xxxx | zzzz 4 | yyyy | zzzz 5 | yyyy | zzzz 6 | yyyy | zzzz 7 | yyyy | zzzz JupyterNotebookã¨CLIã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«ä¸Šè¨˜ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ä½œæˆã‚’ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€ã‚„ã‚ŠãŸã„ã“ã¨ã®éƒ½åˆä¸Šã“ã“ã«ãŠã„ã¦ã¯åŸºæœ¬çš„ã«Pythonã§å®Œçµã™ã‚‹ã‚„ã‚Šæ–¹ã§ã‹ã„ã¦ã„ãã¾ã™ã€‚ æ‰‹ã£å–ã‚Šæ—©ãã‚³ãƒ¼ãƒ‰ã‚’è¦‹ãŸã„æ–¹ã¯1.Setupã‚’è¡Œã„ã€https://github.com/srn221B/sample_gxã“ã¡ã‚‰ã‚’å‚è€ƒã«ã©ã†ãã€‚\n1.SetUp ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« FYI: https://docs.greatexpectations.io/docs/guides/setup/installation/local/\npip install great_expectations DataContextã®ä½œæˆ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ(DataContext)ã‚’ä½œæˆã™ã‚‹ã€‚\ngreat_expectations init Using v3 (Batch Request) API ___ _ ___ _ _ _ / __|_ _ ___ __ _| |_ | __|_ ___ __ ___ __| |_ __ _| |_(_)___ _ _ ___ | (_ | '_/ -_) _` | _| | _|\\ \\ / '_ \\/ -_) _| _/ _` | _| / _ \\ ' \\(_-Enterã™ã‚‹ã¨great_expectationsã¨ã„ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒã§ãã€æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ãŒã§ãã‚‹ã€‚\n. â”œâ”€â”€ checkpoints â”œâ”€â”€ expectations â”œâ”€â”€ great_expectations.yml â”œâ”€â”€ plugins â”‚ â””â”€â”€ custom_data_docs â”‚ â”œâ”€â”€ renderers â”‚ â”œâ”€â”€ styles â”‚ â”‚ â””â”€â”€ data_docs_custom_styles.css â”‚ â””â”€â”€ views â”œâ”€â”€ profilers â””â”€â”€ uncommitted # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã™ã¹ãã§ã¯ãªã„ã‚³ãƒ¼ãƒ‰ãŒå…¥ã£ã¦ã„ã‚‹ â”œâ”€â”€ config_variables.yml â”œâ”€â”€ data_docs â””â”€â”€ validations 2.Connect to Data DataSourceã‚’ä½œæˆã™ã‚‹ã€‚  https://docs.greatexpectations.io/assets/images/datasource_works_for_you-4a7ec1df1f7383cbb399dcac296f8895.png\n DataSourceã¯ä¸»ã«Execution Engineã¨DataConnectorã‹ã‚‰æˆã£ã¦ã„ã‚‹ã€‚ä»Šå›ã¯PostgreSQLã«æ¥ç¶šã™ã‚‹ãŸã‚ã®DataSourceã‚’ä½œæˆã™ã‚‹ã®ã§ã“ã¡ã‚‰ã®ãƒšãƒ¼ã‚¸ã‚’å‚è€ƒã«ã—ãªãŒã‚‰ä»¥ä¸‹ã®ã‚ˆã†ã«ä½œæˆã™ã‚‹ã€‚\nimport great_expectations as ge context = ge.get_context()  ps_user_name='' ps_password='' ps_host='' ps_port='' ps_db=''  datasource_config = {  \"name\": \"my_datasource\",  \"class_name\": \"Datasource\",  \"execution_engine\": {  \"class_name\": \"SqlAlchemyExecutionEngine\",  \"connection_string\": \\ \tf\"postgresql+psycopg2://{ps_user_name}:{ps_password}@{ps_host}:{ps_port}/{ps_db}\",  },  \"data_connectors\": {  \"default_runtime_data_connector_name\": {  \"class_name\": \"RuntimeDataConnector\",  \"batch_identifiers\": [\"default_identifier_name\"],  },  \"default_inferred_data_connector_name\": {  \"class_name\": \"InferredAssetSqlDataConnector\",  \"include_schema_name\": True,  },  }, } DataSourceã‚’ãƒ†ã‚¹ãƒˆã—ãŸã„ã¨ãã¯yamlã‚’dumpã—ã¦test_yaml_configã«æ¸¡ã›ã°ãƒ†ã‚¹ãƒˆã§ãã‚‹ã€‚\ncontext.test_yaml_config(yaml.dump(datasource_config)) ä½œæˆã—ãŸDataSourceã‚’è¿½åŠ ã™ã‚‹ã€‚ context.add_datasource(**datasource_config) è¿½åŠ ã™ã‚‹ã¨ã€Œgreat_expectations.ymlã€ã®datasourcesã«ã‚‚my_datasourceã®å†…å®¹ãŒåæ˜ ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã‚‹ã€‚\ndatasources: my_datasource: ãƒ»ãƒ»ãƒ» BatchRequestã‚’ä½œæˆã™ã‚‹ã€‚ Datasourceå†…ã®ã©ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œè¨¼ã™ã‚‹ã‹ã‚’BatchRequestã¨ã—ã¦ä½œæˆã™ã‚‹ã€‚ä»Šå›ã¯ãƒ†ãƒ¼ãƒ–ãƒ«å†…ã®å…¨ãƒ‡ãƒ¼ã‚¿ãªã®ã§ä»¥ä¸‹ã®ã‚ˆã†ã«ã‹ãã€‚\nfrom great_expectations.core.batch import BatchRequest tbl_name=\"public.sample_poyo\" batch_request = BatchRequest(  datasource_name=\"my_datasource\",  data_connector_name=\"default_inferred_data_connector_name\",  data_asset_name=tbl_name, ) 3.Create Expectations ã„ããªã‚ŠExpectationã‚’ä½œæˆã—ã¦ã‚‚è‰¯ã„ãŒã€ãƒ‡ãƒ¼ã‚¿ã‚’ç†è§£ã™ã‚‹ãŸã‚ã«Profilingã‚’ã—ã¦ã¿ã‚‹ã€‚\nProfiling)ExpectationSuite/Validatorã®ä½œæˆ Expectationã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã®ExpectationSuiteã¨ã€ExpectationSuiteã¨BatchRequestã®ãƒšã‚¢ã‚’Validatorã«å®šç¾©ã™ã‚‹ã€‚\nsuite_name = \"profiling_suite\" context.create_expectation_suite(  suite_name, overwrite_existing=True ) validator = context.get_validator(  batch_request=batch_request,  expectation_suite_name=suite_name ) Profiling)Profilerã‚’ä½œæˆã—Profilingã—ã¦ã¿ã‚‹ã€‚ UseConfigurableProfilerã¸Validatorã‚’æ¸¡ã™ã¨ProfilerãŒä½œæˆã§ãã‚‹ã€‚ã¾ãŸã€Profilerã«ã¯ä»¥ä¸‹ãŒè¨­å®šã§ãã‚‹ã€‚\n- excluded_expectations: List[str] - é™¤å¤–ã™ã‚‹Expectation - ignored_columns: List[str] - é™¤å¤–ã™ã‚‹column - not_null_only: bool - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§NULLã‹ã©ã†ã‹ã‚’è©•ä¾¡ã™ã‚‹ExpectationãŒNULLç‡ã«ã‚ˆã£ã¦å…¥ã‚‹ã‚ã‘ã ãŒ,ã“ã¡ã‚‰ã‚’Trueã«ã™ã‚‹ã¨NULLç‡ã«é–¢ä¿‚ãªãNOT NULLãŒmustãªExpectationãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚ - primary_or_compound_key: List[str] - ä¸»ã‚­ãƒ¼ã‚„è¤‡åˆã‚­ãƒ¼ã‚’æŒ‡å®šã™ã‚‹ã¨ã€uniqueã‹ã©ã†ã‹è©•ä¾¡ã™ã‚‹ExpectationãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚ - table_expectations_only - ã“ã¡ã‚‰ã‚’Trueã«ã™ã‚‹ã¨ã€tableãƒ¬ãƒ™ãƒ«ã®Expectationã®ã¿ã‚’ä½œæˆã™ã‚‹ã€‚ - ãã®ã»ã‹ï¼šhttps://docs.greatexpectations.io/docs/guides/expectations/how_to_create_and_edit_expectations_with_a_profiler#optional-parameters ä»Šå›ã¯ã€ignored_columnsã§columnã€Œvarchar_column2ã€ã®é™¤å¤–ã‚’è¡Œã†ã€‚\nfrom great_expectations.profile.user_configurable_profiler \\  import UserConfigurableProfiler  profiler = UserConfigurableProfiler( \tprofile_dataset=validator, \tignored_columns=['varchar_column2'] \t) expectation_suit = profiler.build_suite() expectations = expectation_suit['expectations'] for expectation in expectations:  print('---')  print('expectation_type: ' + expectation.expectation_type)  print('kwargs: ' + str(expectation.kwargs)) å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªProfilingçµæœã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã‚‹\nexpectation_type: expect_column_values_to_not_be_null kwargs: {'column': 'int_column'} --- expectation_type: expect_column_values_to_not_be_null kwargs: {'column': 'varchar_column'} --- expectation_type: expect_column_values_to_be_in_set kwargs: {'value_set': ['xxxx', 'yyyy'], 'column': 'varchar_column'}  1ã¤ç›®ã¨2ã¤ç›®ã¯columnã€Œint_columnã€ã€Œvarchar_columnã€ã«ã¯NULLãŒå…¥ã‚‰ãªã„ã€‚ 3ã¤ç›®ã¯columnã€Œvarchar_columnã€ã«ã¯â€™xxxxâ€™ã‹â€™yyyyâ€™ã®valueãŒå…¥ã‚‹ã€‚  ã¨ã„ã†æ„å‘³ã ã€‚ å„expectation_typeã‚„ãã‚Œãã‚Œã®kwargsã«ã¤ã„ã¦ã¯ã“ã¡ã‚‰ã®ãƒšãƒ¼ã‚¸ã‹ã‚‰èª¿ã¹ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚\nExpectationã®ä½œæˆ ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦ç†è§£ã§ããŸã®ã§ã€Expectationã‚’ä½œæˆã—ã¦ã¿ã‚‹ã€‚å…·ä½“çš„ã«ã¯Profilingçµæœã‚’å‚è€ƒã«ä»¥ä¸‹ã®Expectationã‚’ã“ã“ã§ã¯å®šç¾©ã™ã‚‹ã€‚\n columnã€Œint_columnã€ã¯NULLãŒå…¥ã‚‰ãªã„ã€‚ columnã€Œint_columnã€ã¯0~7ã®valueã§ã‚ã‚‹ã€‚ columnã€Œvarchar_columnã€ã¯NULLãŒå…¥ã‚‰ãªã„ã€‚ columnã€Œvarchar_columnã€ã¯â€™xxxxâ€™ã‹â€™yyyyâ€™ã®valueãŒå…¥ã‚‹ã€‚  ExpectationConfigurationã«æ¸¡ã™ã€expectation_typeã¨kwargsã«ã¤ã„ã¦ã¯Profilingã—ãŸæ™‚ã¨åŒã˜ã“ã¡ã‚‰ã®ãƒšãƒ¼ã‚¸ã‚’å‚è€ƒã«è¡Œã†ã€‚\n# æ–°è¦suiteã¨validatorã®ä½œæˆ suite_name = \"ex_suite\" context.create_expectation_suite(  suite_name, overwrite_existing=True ) validator = context.get_validator(  batch_request=batch_request,  expectation_suite_name=suite_name )  # Expectationã®ä½œæˆ from great_expectations.core.expectation_configuration import ExpectationConfiguration e1 = ExpectationConfiguration( # columnã€Œint_columnã€ã¯NULLãŒå…¥ã‚‰ãªã„ã€‚  expectation_type=\"expect_column_values_to_not_be_null\",  kwargs={  \"column\": \"int_column\"} ) e2 = ExpectationConfiguration(ã€€# columnã€Œint_columnã€ã¯0~7ã®valueã§ã‚ã‚‹ã€‚  expectation_type=\"expect_column_values_to_be_between\",  kwargs={  \"column\": \"int_column\",  \"min_value\": 0,  \"max_value\": 7} ) e3 = ExpectationConfiguration( # columnã€Œvarchar_columnã€ã¯NULLãŒå…¥ã‚‰ãªã„ã€‚  expectation_type=\"expect_column_values_to_not_be_null\",  kwargs={  \"column\": \"varchar_column\"} ) e4 = ExpectationConfiguration( # columnã€Œvarchar_columnã€ã¯'xxxx'ã‹'yyyy'ã®valueãŒå…¥ã‚‹ã€‚  expectation_type=\"expect_column_values_to_be_in_set\",  kwargs={  \"column\": \"varchar_column\",  \"value_set\": ['xxxx', 'yyyy']} ) ExpectationSuiteã¸Expectationã®è¿½åŠ  expectationã‚’ã¾ã¨ã‚ã¦æ¸¡ã™expectation_configurationsã¯ã€ version0.15.*ã‹ã‚‰ä½¿ãˆã‚‹ã¿ãŸã„ã€‚\nsuite.add_expectation_configurations(  expectation_configurations=[e1,e2,e3,e4]) context.save_expectation_suite(suite, \"test_suite2\") Validatorã‚’ä½œæˆã—Validateã—ã¦ã¿ã‚‹ã€‚ batch_requestã¨expectation_suiteã®æº–å‚™ãŒã§ããŸã®ã§ã€Validatorã‚’ä½œæˆã—ã¦Validateã—ã¦ã¿ã‚‹ã€‚\nres = validator.validate() çµæœã‚’è¡¨ç¤ºã—ã¦ã¿ã‚‹ã€‚ for r in res['results']:  print('---')  print(f'expectation_type: {r.expectation_config.expectation_type}')  print(f'kwargs: {r.expectation_config.kwargs}')  print(f'success: {r.success}')  print(f'result: {r.result}') ä¸Šè¨˜ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªå®Ÿè¡ŒçµæœãŒè¦‹ãˆã‚‹ã€‚\n--- expectation_type: expect_column_values_to_not_be_null kwargs: {'column': 'int_column', 'batch_id': 'b431836ba46465a1106559d8e5ff2656'} success: True result: {'element_count': 8, 'unexpected_count': 0, 'unexpected_percent': 0.0, 'partial_unexpected_list': []} --- expectation_type: expect_column_values_to_be_between kwargs: {'column': 'int_column', 'max_value': 7, 'min_value': 0, 'batch_id': 'b431836ba46465a1106559d8e5ff2656'} success: True result: {'element_count': 8, 'unexpected_count': 0, 'unexpected_percent': 0.0, 'partial_unexpected_list': [], 'missing_count': 0, 'missing_percent': 0.0, 'unexpected_percent_total': 0.0, 'unexpected_percent_nonmissing': 0.0} --- expectation_type: expect_column_values_to_not_be_null kwargs: {'column': 'varchar_column', 'batch_id': 'b431836ba46465a1106559d8e5ff2656'} success: True result: {'element_count': 8, 'unexpected_count': 0, 'unexpected_percent': 0.0, 'partial_unexpected_list': []} --- expectation_type: expect_column_values_to_be_in_set kwargs: {'column': 'varchar_column', 'value_set': ['xxxx', 'yyyy'], 'batch_id': 'b431836ba46465a1106559d8e5ff2656'} success: True result: {'element_count': 8, 'unexpected_count': 0, 'unexpected_percent': 0.0, 'partial_unexpected_list': [], 'missing_count': 0, 'missing_percent': 0.0, 'unexpected_percent_total': 0.0, 'unexpected_percent_nonmissing': 0.0} è©¦ã—ã«ä»¥ä¸‹ã®è¡Œã‚’è¿½åŠ ã—ã¦ã€ã€2. columnã€Œint_columnã€ã¯0~7ã®valueã§ã‚ã‚‹ã€‚ã€ã«åã™ã‚‹ã‚ˆã†ã«ã—ã¦ã¿ã‚‹ã€‚\n DDL  INSERT INTO sample_poyo VALUES (9, 'xxxx', 'zzzz');  ãƒ‡ãƒ¼ã‚¿å†…å®¹   int_column | varchar_column | varchar_column2 ------------+----------------+----------------- 0 | xxxx | zzzz 1 | xxxx | zzzz 2 | xxxx | zzzz 3 | xxxx | zzzz 4 | yyyy | zzzz 5 | yyyy | zzzz 6 | yyyy | zzzz 7 | yyyy | zzzz 9 | yyyy | zzzz ãã†ã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«çµæœãŒå¤‰ã‚ã‚‹ã€‚æ¤œè¨¼å¯¾è±¡ï¼™è¡Œ(element_count)ã®ã†ã¡1è¡Œ(unexpected_count)ãŒæœŸå¾…é€šã‚Šã§ã¯ãªã„ã€ã¨ã„ã†æ„å‘³ã ã€‚\nexpectation_type: expect_column_values_to_be_between kwargs: {'column': 'int_column', 'max_value': 7, 'min_value': 0, 'batch_id': 'b431836ba46465a1106559d8e5ff2656'} success: False result: {'element_count': 9, 'unexpected_count': 1, 'unexpected_percent': 11.11111111111111, 'partial_unexpected_list': [9], 'missing_count': 0, 'missing_percent': 0.0, 'unexpected_percent_total': 11.11111111111111, 'unexpected_percent_nonmissing': 11.11111111111111} ã¤ã¾ã¥ã„ãŸãƒã‚¤ãƒ³ãƒˆ ä»Šå›æŒ‡å®šã—ãŸã‚ˆã†ã«ã€SqlAlchemyã‚’æ´»ç”¨ã—ãŸDataSourceã‚’ä½œæˆã—ãŸã„å ´åˆ(execution_engine.class_nameã«SqlAlchemyExecutionEngineã‚’æŒ‡å®šã—ãŸDataSourceã®å ´åˆ)ã€create_engineã™ã‚‹æ™‚ã®å¼•æ•°ã¯ã€Œconnection_stringã€ã—ã‹ç¾åœ¨æ¸¡ã›ãªã„ã‚ˆã†ã§ã™ã€‚ https://github.com/great-expectations/great_expectations/issues/6226\nçµ‚ã‚ã‚Šã« GreatExpectationsã¨ã¯ä½•ã‹ã€ãŠã‚ˆã³Pythonã‚’ä½¿ã£ãŸä½¿ã„æ–¹ã«ã¤ã„ã¦èª¬æ˜ã—ã¦ã„ãã¾ã—ãŸã€‚ ä»Šå›ã¯ä½¿ã„ã¾ã›ã‚“ã§ã—ãŸãŒRuntimeBatchRequestã‚’ä½¿ãˆã°æ¤œè¨¼ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã‚’éƒ½åº¦æŸ”è»Ÿã«æŒ‡å®šã§ãã‚‹ã¨ã“ã‚ã€Queryã‚’æ›¸ã‹ãšã«Expectationã‚’å®šç¾©ã§ãã‚‹ã¨ã“ã‚ã€åŠã³ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã§ãã‚Œã‚‰ãŒç®¡ç†ã§ãã‚‹ã¨ã“ã‚ãŒå€‹äººçš„ã«è‰¯ã„ã‹ãªã¨æ€ã£ã¦ã„ã¾ã™ã€‚\n","wordCount":"848","inLanguage":"en","image":"https://user-images.githubusercontent.com/60976262/191047722-dd7ed9ad-6e00-4b50-8073-24ae9602b8d6.png","datePublished":"2022-12-11T11:30:03Z","dateModified":"2022-12-11T11:30:03Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://467tn.com/post/content6/"},"publisher":{"@type":"Organization","name":"-1.9517320122461623","logo":{"@type":"ImageObject","url":"https://github.com/srn221B/srn221B.github.io/assets/60976262/00ebf8b5-eceb-4f87-8e70-df54f431a9b8"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://467tn.com accesskey=h title="  (Alt + H)"><img src=https://467tn.com/home2.png alt aria-label=logo height=35></a><div class=logo-switches></div></div><ul id=menu><li><a href=https://467tn.com/ title=whoami><span>whoami</span></a></li><li><a href=https://467tn.com/archives/ title=archive><span>archive</span></a></li><li><a href=https://467tn.com/tags/ title=tags><span>tags</span></a></li><li><a href=https://filmarks.com/users/467 title=ğŸ¥filmarks><span>ğŸ¥filmarks</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://booklog.jp/users/467 title=ğŸ“šbooklog><span>ğŸ“šbooklog</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://zenn.dev/467 title="ğŸ—’ zenn"><span>ğŸ—’ zenn</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://s6n.hatenablog.com/ title=ğŸ›«travels><span>ğŸ›«travels</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://467tn.com>Home</a>&nbsp;Â»&nbsp;<a href=https://467tn.com/post/>Posts</a></div><h1 class=post-title style=color:#164b60>Great Expectationsã«ã¤ã„ã¦èª¿ã¹ã¦ã¿ãŸ</h1><div class=post-description>èª¿ã¹ãŸã“ã¨ã¨è©¦ã—ã¦ã¿ãŸã“ã¨ã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã‚ã‚Šã¾ã™ã€‚</div><div class=post-meta><span title="2022-12-11 11:30:03 +0000 +0000">December 11, 2022</span>&nbsp;Â·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/srn221B/blog/tree/master/content/post/content6.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#æ¦‚è¦>æ¦‚è¦</a></li><li><a href=#great-expectationsã¨ã¯>Great Expectationsã¨ã¯</a><ul><li><a href=#ã§ãã‚‹ã“ã¨>ã§ãã‚‹ã“ã¨</a></li><li><a href=#ä½•ãŒå¬‰ã—ã„ã®ã‹>ä½•ãŒå¬‰ã—ã„ã®ã‹</a></li><li><a href=#ä¼¼ã¦ã„ã‚‹ã‚‚ã®>ä¼¼ã¦ã„ã‚‹ã‚‚ã®</a></li><li><a href=#ã§ããªã„ã“ã¨>ã§ããªã„ã“ã¨</a></li><li><a href=#ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ä½œæˆã®æµã‚Œ>ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ä½œæˆã®æµã‚Œ</a></li></ul></li><li><a href=#è©¦ã—ã¦ã¿ã‚‹>è©¦ã—ã¦ã¿ã‚‹</a><ul><li><a href=#1setup>1.SetUp</a></li><li><a href=#2connect-to-data>2.Connect to Data</a></li><li><a href=#3create-expectations>3.Create Expectations</a></li></ul></li><li><a href=#ã¤ã¾ã¥ã„ãŸãƒã‚¤ãƒ³ãƒˆ>ã¤ã¾ã¥ã„ãŸãƒã‚¤ãƒ³ãƒˆ</a></li><li><a href=#çµ‚ã‚ã‚Šã«>çµ‚ã‚ã‚Šã«</a></li></ul></nav></div></details></div><div class=post-content><p>ã“ã®è¨˜äº‹ã¯<a href=https://qiita.com/advent-calendar/2022/qiita-code-polaris>Qiita x Code Polariså…±å‚¬ï¼å¥³æ€§ITã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒä½œã‚‹ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ Advent Calendar 2022</a>ã®15æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚Qiitaã®ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«å‚åŠ ã™ã‚‹ã®åˆã‚ã¦ã§ã™ï¼ˆwktkï¼‰</p><h2 id=æ¦‚è¦>æ¦‚è¦<a hidden class=anchor aria-hidden=true href=#æ¦‚è¦>#</a></h2><p><a href=https://docs.greatexpectations.io/docs/>Great Expectations</a>(NOT V2)ã«ã¤ã„ã¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã¿ãªãŒã‚‰ã‚ã‹ã£ãŸã“ã¨ã€è©¦ã—ãŸã“ã¨ã‚’ã¾ã¨ã‚ã‚‹ã€‚</p><h2 id=great-expectationsã¨ã¯>Great Expectationsã¨ã¯<a hidden class=anchor aria-hidden=true href=#great-expectationsã¨ã¯>#</a></h2><p>ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³(æ¤œè¨¼)ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã€ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°(æ¦‚è¦å®šç¾©)ã‚’ã—ã¦ãã‚Œã‚‹Pythonã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚Superconductiveç¤¾ãŒé–‹ç™ºã—ã¦ã„ã‚‹OSSã€‚GXã¨ç•¥ã•ã‚Œã‚‹ã‚‰ã—ã„ã€‚</p><h3 id=ã§ãã‚‹ã“ã¨>ã§ãã‚‹ã“ã¨<a hidden class=anchor aria-hidden=true href=#ã§ãã‚‹ã“ã¨>#</a></h3><ul><li><strong>ãƒ‡ãƒ¼ã‚¿ã®æœŸå¾…ã®å®šç¾©(Expectation)</strong><ul><li>oO(xxxã®ã‚«ãƒ©ãƒ ã¯NULLãŒãªã„ã¯ãšã ï¼)</li><li>oO(yyyã®ã‚«ãƒ©ãƒ ã¯AAã‚‚ã—ãã¯BBã—ã‹å€¤ãŒå…¥ã‚‰ãªã„ã¯ãšã ï¼)</li><li>ã¨ã„ã£ãŸã‚ˆã†ãªæœŸå¾…ã®å®šç¾©ã€‚</li></ul></li><li><strong>ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•çš„ãªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°(Profiling)</strong><ul><li>ã€Œxxxã®ã‚«ãƒ©ãƒ ã¯NULLãŒãªã„ã§ã™ã€</li><li>ã€Œyyyã®ã‚«ãƒ©ãƒ ã¯AAã‚‚ã—ãã¯BBã—ã‹å€¤ãŒå…¥ã‚‰ãªã„ã§ã™ã€</li><li>ã¿ãŸã„ãªãƒ‡ãƒ¼ã‚¿ã®æ¦‚è¦ã®è‡ªå‹•çš„ãªå®šç¾©</li></ul></li><li><strong>ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³(Validation)</strong><ul><li>å®šç¾©ã—ãŸExpectationãŒæœŸå¾…é€šã‚Šã‹ã®æ¤œè¨¼ã€‚</li></ul></li><li><strong>ãƒ‡ãƒ¼ã‚¿ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–</strong><ul><li>å®šç¾©ã—ãŸExpectationã‚’Validationã—ãŸçµæœã®ç¢ºèªã€‚</li></ul></li><li><strong>ã•ã¾ã–ã¾ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚„ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ã‹ã‚‰ã®ãƒ­ãƒ¼ãƒ‰</strong><ul><li>Pandasã‚„Sparkãªã©ã®Dataframeã‚„ã€SQLDatabaseåŠã³ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰</li></ul></li></ul><h3 id=ä½•ãŒå¬‰ã—ã„ã®ã‹>ä½•ãŒå¬‰ã—ã„ã®ã‹<a hidden class=anchor aria-hidden=true href=#ä½•ãŒå¬‰ã—ã„ã®ã‹>#</a></h3><p>ãƒ‡ãƒ¼ã‚¿ã®å“è³ªç®¡ç†ãŒã§ãã‚‹ ->ã€€ãƒã‚°,éå»åˆ†ãƒ‡ãƒ¼ã‚¿ã®ä¿®æ­£ã®æ—©æœŸå¯¾å¿œã€‚</p><h3 id=ä¼¼ã¦ã„ã‚‹ã‚‚ã®>ä¼¼ã¦ã„ã‚‹ã‚‚ã®<a hidden class=anchor aria-hidden=true href=#ä¼¼ã¦ã„ã‚‹ã‚‚ã®>#</a></h3><ul><li><a href=https://www.getdbt.com/>dbt</a>ã®ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã€‚</li><li><a href=https://www.kubeflow.org/>kubeflow</a>ã®Validationæ©Ÿèƒ½ã€‚</li></ul><h3 id=ã§ããªã„ã“ã¨>ã§ããªã„ã“ã¨<a hidden class=anchor aria-hidden=true href=#ã§ããªã„ã“ã¨>#</a></h3><ul><li><strong>Pipelineã®å®Ÿè¡Œ</strong><ul><li>ã‚ãã¾ã§Pythonã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚</li><li>ä¾‹ãˆã°ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚’ã—ãŸã„ã¨ãªã£ãŸæ™‚ã€GXã®æ©Ÿèƒ½ã‚’æ´»ã‹ã—ã¦ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã®Pipelineï¼ˆæµã‚Œï¼‰ã‚’ä½œã£ã¦ã„ãã‚ã‘ã ãŒã€ä½œã£ãŸPipelineã®ã‚¹ãƒ†ãƒƒãƒ—æ¯ã®å®Ÿè¡Œã¯ã§ãã‚‹ãŒã€å…¨ä½“ã‚’é€šã—ãŸå®Ÿè¡Œã¯å˜ä½“ã§ã§ããªã„ã€‚ãªã®ã§ã€Airflow,dbt,Prefect,Dagster,Kedroã®ã‚ˆã†ãªDAGã‚’å®Ÿè¡Œã™ã‚‹ãƒ„ãƒ¼ãƒ«ã¨çµ±åˆã™ã‚‹ã¨è‰¯ã„ã€‚ã€€</li></ul></li><li><strong>ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†</strong><ul><li>ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã™ã‚‹ãªã‚‰DVCã‚„Quikltãªã©ã‚’ä½¿ã†ã¨è‰¯ã„ã€‚</li></ul></li><li><strong>Pythonã®ç’°å¢ƒä»¥å¤–ã§æœ€é©ãªçŠ¶æ…‹ã§å‹•ãã“ã¨</strong><ul><li>Pythonã§ã§ãã¦ã„ã‚‹ã®ã§</li><li>é•ã†è¨€èªã‚„ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰å‘¼ã³å‡ºã™ã¨ãã€CLIã‹ã‚‰å‘¼ã³å‡ºã—ãªã‚“ã¨ã‹ã™ã‚‹ã¨ã„ã†ã“ã¨ã‚‚ã§ãã‚‹ãŒã€è¨€èªã‚„ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã«æ²¿ã£ãŸã‚‚ã®ã‚’é¸æŠã™ã‚‹æ–¹ãŒè‰¯ã„ã€ï¼ˆR->assertR, TensorFlow->TFDVï¼‰</li></ul></li></ul><h3 id=ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ä½œæˆã®æµã‚Œ>ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ä½œæˆã®æµã‚Œ<a hidden class=anchor aria-hidden=true href=#ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ä½œæˆã®æµã‚Œ>#</a></h3><p>ã§ã¯ã€GreatExpectationsã‚’ä½¿ç”¨ã—ã¦ä¾‹ãˆã°ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚’ä½œæˆã—ãŸã„ã¨ãªã£ãŸã‚‰ä½•ã‚’ã—ãŸã‚‰è‰¯ã„ã®ã€ã¨ãªã‚‹ã®ã ãŒä»¥ä¸‹ã®ç”»åƒãŒå‚è€ƒã«ãªã‚‹ã€‚
<img loading=lazy src=https://storage.googleapis.com/zenn-user-upload/d392dd1323a2-20221205.png alt></p><blockquote><p><a href=https://docs.greatexpectations.io/assets/images/data_context_does_for_you-df2eca32d0152ead16cccd5d3d226abb.png>https://docs.greatexpectations.io/assets/images/data_context_does_for_you-df2eca32d0152ead16cccd5d3d226abb.png</a></p></blockquote><p>è£œè¶³ã™ã‚‹ã¨</p><ul><li>1.Setup<ul><li>ã€ŒDataContextã€ã®ä½œæˆ</li><li>å¿…è¦ã‚ã‚Œã°ï¼‰æ‹¡å¼µæ©Ÿèƒ½(Plugins)ã®è¨­å®šã‚„Validationçµæœãªã©ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹å ´æ‰€ã®è¨­å®š</li></ul></li><li>2.Connect to Data<ul><li>ã€ŒDataSourcesã€ã®ä½œæˆ</li><li>ã€ŒBatchRequestã€/ã€ŒRuntimeBatchRequestã€ã®ä½œæˆ</li></ul></li><li>3.Create Expectations<ul><li>Profilingã™ã‚‹ãªã©ã‚’ã—ã¦ã€ŒExpectationSuiteã€ã®ä½œæˆ</li></ul></li><li>4.Validate Data<ul><li>Validatorã‚’ä½¿ç”¨ã—ã¦ã€ä½œæˆã—ãŸã€ŒExpectation Suiteã€ã¨ã€ŒBatchRequestã€ã®ãƒšã‚¢ã®æ¤œè¨¼</li><li>CheckPointã‚’ä½¿ç”¨ã—ã¦ã€ä½œæˆã—ãŸã€ŒExpectation Suiteã€ã¨ã€ŒBatchRequestã€ã®ãƒšã‚¢ã‚’è¤‡æ•°ã¾ã¨ã‚ã€æ¤œè¨¼</li></ul></li></ul><table><thead><tr><th>ç”¨èª</th><th>ä½•</th></tr></thead><tbody><tr><td>DataContext</td><td>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚ˆã†ãªã‚‚ã®</td></tr><tr><td>DataSources</td><td>æ¤œè¨¼ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã®Connector</td></tr><tr><td>BatchRequest</td><td>DataSourceså†…ã®ã©ã®ãƒ‡ãƒ¼ã‚¿ã‹ã®å®šç¾©(TBLæŒ‡å®š)</td></tr><tr><td>RuntimeBatchRequest</td><td>DataSourceså†…ã®ã©ã®ãƒ‡ãƒ¼ã‚¿ã‹ã®å®šç¾©(QueryæŒ‡å®š)</td></tr><tr><td>Expectation</td><td>ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹æœŸå¾…</td></tr><tr><td>ExpectationSuite</td><td>Expectationã®é›†ã¾ã‚Š</td></tr></tbody></table><p>1ã«ã¤ã„ã¦ã¯CLIã‹ã‚‰è¡Œã†ã“ã¨ãŒã§ãã‚‹
2~4ã«ã¤ã„ã¦ã¯CLIã‚„Python,JupyterNotebookã‹ã‚‰è¡Œã†ã“ã¨ãŒã§ãã‚‹</p><h2 id=è©¦ã—ã¦ã¿ã‚‹>è©¦ã—ã¦ã¿ã‚‹<a hidden class=anchor aria-hidden=true href=#è©¦ã—ã¦ã¿ã‚‹>#</a></h2><p>ä¸Šè¨˜ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ä½œæˆã‚’ãªãã£ã¦ã¿ã‚‹ã€‚</p><ul><li>ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦<ul><li>SQLDBï¼šPostgreSQL</li></ul></li><li>DML</li></ul><pre tabindex=0><code>CREATE TABLE sample_poyo (
  int_column INTEGER, 
  varchar_column VARCHAR(10),
  varchar_column2 VARCHAR(10));
</code></pre><ul><li>DDL</li></ul><pre tabindex=0><code>INSERT INTO sample_poyo VALUES (0, &#39;xxxx&#39;, &#39;zzzz&#39;);
INSERT INTO sample_poyo VALUES (1, &#39;xxxx&#39;, &#39;zzzz&#39;);
INSERT INTO sample_poyo VALUES (2, &#39;xxxx&#39;, &#39;zzzz&#39;);
INSERT INTO sample_poyo VALUES (3, &#39;xxxx&#39;, &#39;zzzz&#39;);
INSERT INTO sample_poyo VALUES (4, &#39;yyyy&#39;, &#39;zzzz&#39;);
INSERT INTO sample_poyo VALUES (5, &#39;yyyy&#39;, &#39;zzzz&#39;);
INSERT INTO sample_poyo VALUES (6, &#39;yyyy&#39;, &#39;zzzz&#39;);
INSERT INTO sample_poyo VALUES (7, &#39;yyyy&#39;, &#39;zzzz&#39;);
</code></pre><ul><li>ãƒ‡ãƒ¼ã‚¿å†…å®¹</li></ul><pre tabindex=0><code> int_column | varchar_column | varchar_column2 
------------+----------------+-----------------
         0 | xxxx           | zzzz
         1 | xxxx           | zzzz
         2 | xxxx           | zzzz
         3 | xxxx           | zzzz
         4 | yyyy           | zzzz
         5 | yyyy           | zzzz
         6 | yyyy           | zzzz
         7 | yyyy           | zzzz
</code></pre><p>JupyterNotebookã¨CLIã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«ä¸Šè¨˜ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ä½œæˆã‚’ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€ã‚„ã‚ŠãŸã„ã“ã¨ã®éƒ½åˆä¸Šã“ã“ã«ãŠã„ã¦ã¯<strong>åŸºæœ¬çš„ã«Pythonã§å®Œçµã™ã‚‹ã‚„ã‚Šæ–¹ã§ã‹ã„ã¦ã„ãã¾ã™ã€‚</strong>
æ‰‹ã£å–ã‚Šæ—©ãã‚³ãƒ¼ãƒ‰ã‚’è¦‹ãŸã„æ–¹ã¯1.Setupã‚’è¡Œã„ã€<a href=https://github.com/srn221B/sample_gx>https://github.com/srn221B/sample_gx</a>ã“ã¡ã‚‰ã‚’å‚è€ƒã«ã©ã†ãã€‚</p><h3 id=1setup>1.SetUp<a hidden class=anchor aria-hidden=true href=#1setup>#</a></h3><h4 id=ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a hidden class=anchor aria-hidden=true href=#ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«>#</a></h4><p>FYI: <a href=https://docs.greatexpectations.io/docs/guides/setup/installation/local/>https://docs.greatexpectations.io/docs/guides/setup/installation/local/</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pip install great_expectations
</span></span></code></pre></div><h4 id=datacontextã®ä½œæˆ>DataContextã®ä½œæˆ<a hidden class=anchor aria-hidden=true href=#datacontextã®ä½œæˆ>#</a></h4><p>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ(DataContext)ã‚’ä½œæˆã™ã‚‹ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>great_expectations init
</span></span></code></pre></div><pre tabindex=0><code>Using v3 (Batch Request) API

  ___              _     ___                  _        _   _
 / __|_ _ ___ __ _| |_  | __|_ ___ __  ___ __| |_ __ _| |_(_)___ _ _  ___
| (_ | &#39;_/ -_) _` |  _| | _|\ \ / &#39;_ \/ -_) _|  _/ _` |  _| / _ \ &#39; \(_-&lt;
 \___|_| \___\__,_|\__| |___/_\_\ .__/\___\__|\__\__,_|\__|_\___/_||_/__/
                                |_|
             ~ Always know what to expect from your data ~

Let&#39;s create a new Data Context to hold your project configuration.

Great Expectations will create a new directory with the following structure:

    great_expectations
    |-- great_expectations.yml
    |-- expectations
    |-- checkpoints
    |-- plugins
    |-- .gitignore
    |-- uncommitted
        |-- config_variables.yml
        |-- data_docs
        |-- validations

OK to proceed? [Y/n]: &lt;press Enter&gt;
</code></pre><p>Enterã™ã‚‹ã¨great_expectationsã¨ã„ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒã§ãã€æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ãŒã§ãã‚‹ã€‚</p><pre tabindex=0><code>.
â”œâ”€â”€ checkpoints
â”œâ”€â”€ expectations
â”œâ”€â”€ great_expectations.yml
â”œâ”€â”€ plugins
â”‚   â””â”€â”€ custom_data_docs
â”‚       â”œâ”€â”€ renderers
â”‚       â”œâ”€â”€ styles
â”‚       â”‚   â””â”€â”€ data_docs_custom_styles.css
â”‚       â””â”€â”€ views
â”œâ”€â”€ profilers
â””â”€â”€ uncommitted # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã™ã¹ãã§ã¯ãªã„ã‚³ãƒ¼ãƒ‰ãŒå…¥ã£ã¦ã„ã‚‹
    â”œâ”€â”€ config_variables.yml
    â”œâ”€â”€ data_docs
    â””â”€â”€ validations
</code></pre><h3 id=2connect-to-data>2.Connect to Data<a hidden class=anchor aria-hidden=true href=#2connect-to-data>#</a></h3><h4 id=datasourceã‚’ä½œæˆã™ã‚‹>DataSourceã‚’ä½œæˆã™ã‚‹ã€‚<a hidden class=anchor aria-hidden=true href=#datasourceã‚’ä½œæˆã™ã‚‹>#</a></h4><p><img loading=lazy src=https://storage.googleapis.com/zenn-user-upload/c42b612fc635-20221205.png alt></p><blockquote><p><a href=https://docs.greatexpectations.io/assets/images/datasource_works_for_you-4a7ec1df1f7383cbb399dcac296f8895.png>https://docs.greatexpectations.io/assets/images/datasource_works_for_you-4a7ec1df1f7383cbb399dcac296f8895.png</a></p></blockquote><p>DataSourceã¯ä¸»ã«<a href=https://github.com/great-expectations/great_expectations/blob/e5249f4b445a22e015cbcb07f6e45ecf516e698f/great_expectations/execution_engine/execution_engine.py#L197>Execution Engine</a>ã¨<a href=https://github.com/great-expectations/great_expectations/blob/e5249f4b445a22e015cbcb07f6e45ecf516e698f/great_expectations/datasource/data_connector/data_connector.py#L20>DataConnector</a>ã‹ã‚‰æˆã£ã¦ã„ã‚‹ã€‚ä»Šå›ã¯PostgreSQLã«æ¥ç¶šã™ã‚‹ãŸã‚ã®DataSourceã‚’ä½œæˆã™ã‚‹ã®ã§<a href=https://docs.greatexpectations.io/docs/guides/connecting_to_your_data/database/postgres>ã“ã¡ã‚‰ã®ãƒšãƒ¼ã‚¸</a>ã‚’å‚è€ƒã«ã—ãªãŒã‚‰ä»¥ä¸‹ã®ã‚ˆã†ã«ä½œæˆã™ã‚‹ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> great_expectations <span style=color:#66d9ef>as</span> ge
</span></span><span style=display:flex><span>context <span style=color:#f92672>=</span> ge<span style=color:#f92672>.</span>get_context()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ps_user_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>ps_password<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>ps_host<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>ps_port<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>ps_db<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>datasource_config <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;my_datasource&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;class_name&#34;</span>: <span style=color:#e6db74>&#34;Datasource&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;execution_engine&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;class_name&#34;</span>: <span style=color:#e6db74>&#34;SqlAlchemyExecutionEngine&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;connection_string&#34;</span>: \
</span></span><span style=display:flex><span>		<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;postgresql+psycopg2://</span><span style=color:#e6db74>{</span>ps_user_name<span style=color:#e6db74>}</span><span style=color:#e6db74>:</span><span style=color:#e6db74>{</span>ps_password<span style=color:#e6db74>}</span><span style=color:#e6db74>@</span><span style=color:#e6db74>{</span>ps_host<span style=color:#e6db74>}</span><span style=color:#e6db74>:</span><span style=color:#e6db74>{</span>ps_port<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>{</span>ps_db<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;data_connectors&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;default_runtime_data_connector_name&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;class_name&#34;</span>: <span style=color:#e6db74>&#34;RuntimeDataConnector&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;batch_identifiers&#34;</span>: [<span style=color:#e6db74>&#34;default_identifier_name&#34;</span>],
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;default_inferred_data_connector_name&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;class_name&#34;</span>: <span style=color:#e6db74>&#34;InferredAssetSqlDataConnector&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;include_schema_name&#34;</span>: <span style=color:#66d9ef>True</span>,
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>DataSourceã‚’ãƒ†ã‚¹ãƒˆã—ãŸã„ã¨ãã¯yamlã‚’dumpã—ã¦test_yaml_configã«æ¸¡ã›ã°ãƒ†ã‚¹ãƒˆã§ãã‚‹ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>context<span style=color:#f92672>.</span>test_yaml_config(yaml<span style=color:#f92672>.</span>dump(datasource_config))
</span></span></code></pre></div><h4 id=ä½œæˆã—ãŸdatasourceã‚’è¿½åŠ ã™ã‚‹>ä½œæˆã—ãŸDataSourceã‚’è¿½åŠ ã™ã‚‹ã€‚<a hidden class=anchor aria-hidden=true href=#ä½œæˆã—ãŸdatasourceã‚’è¿½åŠ ã™ã‚‹>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>context<span style=color:#f92672>.</span>add_datasource(<span style=color:#f92672>**</span>datasource_config)
</span></span></code></pre></div><p>è¿½åŠ ã™ã‚‹ã¨ã€Œgreat_expectations.ymlã€ã®<code>datasources</code>ã«ã‚‚<code>my_datasource</code>ã®å†…å®¹ãŒåæ˜ ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã‚‹ã€‚</p><pre tabindex=0><code>datasources:
  my_datasource:
ãƒ»ãƒ»ãƒ»
</code></pre><h4 id=batchrequestã‚’ä½œæˆã™ã‚‹>BatchRequestã‚’ä½œæˆã™ã‚‹ã€‚<a hidden class=anchor aria-hidden=true href=#batchrequestã‚’ä½œæˆã™ã‚‹>#</a></h4><p>Datasourceå†…ã®ã©ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œè¨¼ã™ã‚‹ã‹ã‚’<a href=https://github.com/great-expectations/great_expectations/blob/e5249f4b445a22e015cbcb07f6e45ecf516e698f/great_expectations/core/batch.py#L390>BatchRequest</a>ã¨ã—ã¦ä½œæˆã™ã‚‹ã€‚ä»Šå›ã¯ãƒ†ãƒ¼ãƒ–ãƒ«å†…ã®å…¨ãƒ‡ãƒ¼ã‚¿ãªã®ã§ä»¥ä¸‹ã®ã‚ˆã†ã«ã‹ãã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> great_expectations.core.batch <span style=color:#f92672>import</span> BatchRequest
</span></span><span style=display:flex><span>tbl_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;public.sample_poyo&#34;</span>
</span></span><span style=display:flex><span>batch_request <span style=color:#f92672>=</span> BatchRequest(
</span></span><span style=display:flex><span>    datasource_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;my_datasource&#34;</span>,
</span></span><span style=display:flex><span>    data_connector_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;default_inferred_data_connector_name&#34;</span>,
</span></span><span style=display:flex><span>    data_asset_name<span style=color:#f92672>=</span>tbl_name,
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><h3 id=3create-expectations>3.Create Expectations<a hidden class=anchor aria-hidden=true href=#3create-expectations>#</a></h3><p>ã„ããªã‚ŠExpectationã‚’ä½œæˆã—ã¦ã‚‚è‰¯ã„ãŒã€ãƒ‡ãƒ¼ã‚¿ã‚’ç†è§£ã™ã‚‹ãŸã‚ã«Profilingã‚’ã—ã¦ã¿ã‚‹ã€‚</p><h4 id=profilingexpectationsuitevalidatorã®ä½œæˆ>Profiling)ExpectationSuite/Validatorã®ä½œæˆ<a hidden class=anchor aria-hidden=true href=#profilingexpectationsuitevalidatorã®ä½œæˆ>#</a></h4><p>Expectationã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã®ExpectationSuiteã¨ã€ExpectationSuiteã¨BatchRequestã®ãƒšã‚¢ã‚’<a href=https://github.com/great-expectations/great_expectations/blob/e5249f4b445a22e015cbcb07f6e45ecf516e698f/great_expectations/validator/validator.py#L162>Validator</a>ã«å®šç¾©ã™ã‚‹ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>suite_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;profiling_suite&#34;</span>
</span></span><span style=display:flex><span>context<span style=color:#f92672>.</span>create_expectation_suite(
</span></span><span style=display:flex><span>    suite_name, overwrite_existing<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>validator <span style=color:#f92672>=</span> context<span style=color:#f92672>.</span>get_validator(
</span></span><span style=display:flex><span>    batch_request<span style=color:#f92672>=</span>batch_request,
</span></span><span style=display:flex><span>    expectation_suite_name<span style=color:#f92672>=</span>suite_name
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><h4 id=profilingprofilerã‚’ä½œæˆã—profilingã—ã¦ã¿ã‚‹>Profiling)Profilerã‚’ä½œæˆã—Profilingã—ã¦ã¿ã‚‹ã€‚<a hidden class=anchor aria-hidden=true href=#profilingprofilerã‚’ä½œæˆã—profilingã—ã¦ã¿ã‚‹>#</a></h4><p><a href=https://github.com/great-expectations/great_expectations/blob/e5249f4b445a22e015cbcb07f6e45ecf516e698f/great_expectations/profile/user_configurable_profiler.py#L39>UseConfigurableProfiler</a>ã¸Validatorã‚’æ¸¡ã™ã¨ProfilerãŒä½œæˆã§ãã‚‹ã€‚ã¾ãŸã€Profilerã«ã¯ä»¥ä¸‹ãŒè¨­å®šã§ãã‚‹ã€‚</p><pre tabindex=0><code>- excluded_expectations: List[str]
	- ã€€é™¤å¤–ã™ã‚‹Expectation
- ignored_columns: List[str]
	- é™¤å¤–ã™ã‚‹column
- not_null_only: bool
	- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§NULLã‹ã©ã†ã‹ã‚’è©•ä¾¡ã™ã‚‹ExpectationãŒNULLç‡ã«ã‚ˆã£ã¦å…¥ã‚‹ã‚ã‘ã ãŒ,ã“ã¡ã‚‰ã‚’Trueã«ã™ã‚‹ã¨NULLç‡ã«é–¢ä¿‚ãªãNOT NULLãŒmustãªExpectationãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚
- primary_or_compound_key: List[str]
	- ä¸»ã‚­ãƒ¼ã‚„è¤‡åˆã‚­ãƒ¼ã‚’æŒ‡å®šã™ã‚‹ã¨ã€uniqueã‹ã©ã†ã‹è©•ä¾¡ã™ã‚‹ExpectationãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚
- table_expectations_only
	- ã“ã¡ã‚‰ã‚’Trueã«ã™ã‚‹ã¨ã€tableãƒ¬ãƒ™ãƒ«ã®Expectationã®ã¿ã‚’ä½œæˆã™ã‚‹ã€‚
- ãã®ã»ã‹ï¼šhttps://docs.greatexpectations.io/docs/guides/expectations/how_to_create_and_edit_expectations_with_a_profiler#optional-parameters
</code></pre><p>ä»Šå›ã¯ã€ignored_columnsã§columnã€Œvarchar_column2ã€ã®é™¤å¤–ã‚’è¡Œã†ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> great_expectations.profile.user_configurable_profiler \
</span></span><span style=display:flex><span>    <span style=color:#f92672>import</span> UserConfigurableProfiler
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>profiler <span style=color:#f92672>=</span> UserConfigurableProfiler(
</span></span><span style=display:flex><span>	profile_dataset<span style=color:#f92672>=</span>validator,
</span></span><span style=display:flex><span>	ignored_columns<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;varchar_column2&#39;</span>]
</span></span><span style=display:flex><span>	)
</span></span><span style=display:flex><span>expectation_suit <span style=color:#f92672>=</span> profiler<span style=color:#f92672>.</span>build_suite()
</span></span><span style=display:flex><span>expectations <span style=color:#f92672>=</span> expectation_suit[<span style=color:#e6db74>&#39;expectations&#39;</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> expectation <span style=color:#f92672>in</span> expectations:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;---&#39;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;expectation_type: &#39;</span> <span style=color:#f92672>+</span> expectation<span style=color:#f92672>.</span>expectation_type)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;kwargs: &#39;</span> <span style=color:#f92672>+</span> str(expectation<span style=color:#f92672>.</span>kwargs))
</span></span></code></pre></div><p>å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªProfilingçµæœã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã‚‹</p><pre tabindex=0><code>expectation_type: expect_column_values_to_not_be_null
kwargs: {&#39;column&#39;: &#39;int_column&#39;}
---
expectation_type: expect_column_values_to_not_be_null
kwargs: {&#39;column&#39;: &#39;varchar_column&#39;}
---
expectation_type: expect_column_values_to_be_in_set
kwargs: {&#39;value_set&#39;: [&#39;xxxx&#39;, &#39;yyyy&#39;], &#39;column&#39;: &#39;varchar_column&#39;}
</code></pre><ul><li>1ã¤ç›®ã¨2ã¤ç›®ã¯columnã€Œint_columnã€ã€Œvarchar_columnã€ã«ã¯NULLãŒå…¥ã‚‰ãªã„ã€‚</li><li>3ã¤ç›®ã¯columnã€Œvarchar_columnã€ã«ã¯&rsquo;xxxx&rsquo;ã‹&rsquo;yyyy&rsquo;ã®valueãŒå…¥ã‚‹ã€‚</li></ul><p>ã¨ã„ã†æ„å‘³ã ã€‚
å„expectation_typeã‚„ãã‚Œãã‚Œã®kwargsã«ã¤ã„ã¦ã¯<a href="https://greatexpectations.io/expectations/?filterType=Backend%20support&gotoPage=1&showFilters=false&viewType=Summary">ã“ã¡ã‚‰ã®ãƒšãƒ¼ã‚¸</a>ã‹ã‚‰èª¿ã¹ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚</p><h4 id=expectationã®ä½œæˆ>Expectationã®ä½œæˆ<a hidden class=anchor aria-hidden=true href=#expectationã®ä½œæˆ>#</a></h4><p>ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦ç†è§£ã§ããŸã®ã§ã€Expectationã‚’ä½œæˆã—ã¦ã¿ã‚‹ã€‚å…·ä½“çš„ã«ã¯Profilingçµæœã‚’å‚è€ƒã«ä»¥ä¸‹ã®Expectationã‚’ã“ã“ã§ã¯å®šç¾©ã™ã‚‹ã€‚</p><ol><li>columnã€Œint_columnã€ã¯NULLãŒå…¥ã‚‰ãªã„ã€‚</li><li>columnã€Œint_columnã€ã¯0~7ã®valueã§ã‚ã‚‹ã€‚</li><li>columnã€Œvarchar_columnã€ã¯NULLãŒå…¥ã‚‰ãªã„ã€‚</li><li>columnã€Œvarchar_columnã€ã¯&rsquo;xxxx&rsquo;ã‹&rsquo;yyyy&rsquo;ã®valueãŒå…¥ã‚‹ã€‚</li></ol><p><a href=https://github.com/great-expectations/great_expectations/blob/9fed397a318f5fa773f274f11db2116b65b1dcc9/great_expectations/core/expectation_configuration.py#L96>ExpectationConfiguration</a>ã«æ¸¡ã™ã€expectation_typeã¨kwargsã«ã¤ã„ã¦ã¯Profilingã—ãŸæ™‚ã¨åŒã˜<a href="https://greatexpectations.io/expectations/?filterType=Backend%20support&gotoPage=1&showFilters=false&viewType=Summary">ã“ã¡ã‚‰ã®ãƒšãƒ¼ã‚¸</a>ã‚’å‚è€ƒã«è¡Œã†ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># æ–°è¦suiteã¨validatorã®ä½œæˆ</span>
</span></span><span style=display:flex><span>suite_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ex_suite&#34;</span>
</span></span><span style=display:flex><span>context<span style=color:#f92672>.</span>create_expectation_suite(
</span></span><span style=display:flex><span>    suite_name, overwrite_existing<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>validator <span style=color:#f92672>=</span> context<span style=color:#f92672>.</span>get_validator(
</span></span><span style=display:flex><span>    batch_request<span style=color:#f92672>=</span>batch_request,
</span></span><span style=display:flex><span>    expectation_suite_name<span style=color:#f92672>=</span>suite_name
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Expectationã®ä½œæˆ</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> great_expectations.core.expectation_configuration <span style=color:#f92672>import</span> ExpectationConfiguration
</span></span><span style=display:flex><span>e1 <span style=color:#f92672>=</span> ExpectationConfiguration( <span style=color:#75715e># columnã€Œint_columnã€ã¯NULLãŒå…¥ã‚‰ãªã„ã€‚</span>
</span></span><span style=display:flex><span>   expectation_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;expect_column_values_to_not_be_null&#34;</span>,
</span></span><span style=display:flex><span>   kwargs<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;column&#34;</span>: <span style=color:#e6db74>&#34;int_column&#34;</span>}
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>e2 <span style=color:#f92672>=</span> ExpectationConfiguration(ã€€<span style=color:#75715e># columnã€Œint_columnã€ã¯0~7ã®valueã§ã‚ã‚‹ã€‚</span>
</span></span><span style=display:flex><span>   expectation_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;expect_column_values_to_be_between&#34;</span>,
</span></span><span style=display:flex><span>   kwargs<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;column&#34;</span>: <span style=color:#e6db74>&#34;int_column&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;min_value&#34;</span>: <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;max_value&#34;</span>: <span style=color:#ae81ff>7</span>}
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>e3 <span style=color:#f92672>=</span> ExpectationConfiguration( <span style=color:#75715e># columnã€Œvarchar_columnã€ã¯NULLãŒå…¥ã‚‰ãªã„ã€‚</span>
</span></span><span style=display:flex><span>   expectation_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;expect_column_values_to_not_be_null&#34;</span>,
</span></span><span style=display:flex><span>   kwargs<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;column&#34;</span>: <span style=color:#e6db74>&#34;varchar_column&#34;</span>}
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>e4 <span style=color:#f92672>=</span> ExpectationConfiguration( <span style=color:#75715e># columnã€Œvarchar_columnã€ã¯&#39;xxxx&#39;ã‹&#39;yyyy&#39;ã®valueãŒå…¥ã‚‹ã€‚</span>
</span></span><span style=display:flex><span>   expectation_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;expect_column_values_to_be_in_set&#34;</span>,
</span></span><span style=display:flex><span>   kwargs<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;column&#34;</span>: <span style=color:#e6db74>&#34;varchar_column&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;value_set&#34;</span>: [<span style=color:#e6db74>&#39;xxxx&#39;</span>, <span style=color:#e6db74>&#39;yyyy&#39;</span>]}
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><h4 id=expectationsuiteã¸expectationã®è¿½åŠ >ExpectationSuiteã¸Expectationã®è¿½åŠ <a hidden class=anchor aria-hidden=true href=#expectationsuiteã¸expectationã®è¿½åŠ >#</a></h4><p>expectationã‚’ã¾ã¨ã‚ã¦æ¸¡ã™expectation_configurationsã¯ã€ version0.15.*ã‹ã‚‰ä½¿ãˆã‚‹ã¿ãŸã„ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>suite<span style=color:#f92672>.</span>add_expectation_configurations(
</span></span><span style=display:flex><span>    expectation_configurations<span style=color:#f92672>=</span>[e1,e2,e3,e4])
</span></span><span style=display:flex><span>context<span style=color:#f92672>.</span>save_expectation_suite(suite, <span style=color:#e6db74>&#34;test_suite2&#34;</span>)
</span></span></code></pre></div><h4 id=validatorã‚’ä½œæˆã—validateã—ã¦ã¿ã‚‹>Validatorã‚’ä½œæˆã—Validateã—ã¦ã¿ã‚‹ã€‚<a hidden class=anchor aria-hidden=true href=#validatorã‚’ä½œæˆã—validateã—ã¦ã¿ã‚‹>#</a></h4><p>batch_requestã¨expectation_suiteã®æº–å‚™ãŒã§ããŸã®ã§ã€Validatorã‚’ä½œæˆã—ã¦Validateã—ã¦ã¿ã‚‹ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>res <span style=color:#f92672>=</span> validator<span style=color:#f92672>.</span>validate()
</span></span></code></pre></div><h4 id=çµæœã‚’è¡¨ç¤ºã—ã¦ã¿ã‚‹>çµæœã‚’è¡¨ç¤ºã—ã¦ã¿ã‚‹ã€‚<a hidden class=anchor aria-hidden=true href=#çµæœã‚’è¡¨ç¤ºã—ã¦ã¿ã‚‹>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>for</span> r <span style=color:#f92672>in</span> res[<span style=color:#e6db74>&#39;results&#39;</span>]:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;---&#39;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;expectation_type: </span><span style=color:#e6db74>{</span>r<span style=color:#f92672>.</span>expectation_config<span style=color:#f92672>.</span>expectation_type<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;kwargs: </span><span style=color:#e6db74>{</span>r<span style=color:#f92672>.</span>expectation_config<span style=color:#f92672>.</span>kwargs<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;success: </span><span style=color:#e6db74>{</span>r<span style=color:#f92672>.</span>success<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;result: </span><span style=color:#e6db74>{</span>r<span style=color:#f92672>.</span>result<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span></code></pre></div><p>ä¸Šè¨˜ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªå®Ÿè¡ŒçµæœãŒè¦‹ãˆã‚‹ã€‚</p><pre tabindex=0><code>---
expectation_type: expect_column_values_to_not_be_null
kwargs: {&#39;column&#39;: &#39;int_column&#39;, &#39;batch_id&#39;: &#39;b431836ba46465a1106559d8e5ff2656&#39;}
success: True
result: {&#39;element_count&#39;: 8, &#39;unexpected_count&#39;: 0, &#39;unexpected_percent&#39;: 0.0, &#39;partial_unexpected_list&#39;: []}
---
expectation_type: expect_column_values_to_be_between
kwargs: {&#39;column&#39;: &#39;int_column&#39;, &#39;max_value&#39;: 7, &#39;min_value&#39;: 0, &#39;batch_id&#39;: &#39;b431836ba46465a1106559d8e5ff2656&#39;}
success: True
result: {&#39;element_count&#39;: 8, &#39;unexpected_count&#39;: 0, &#39;unexpected_percent&#39;: 0.0, &#39;partial_unexpected_list&#39;: [], &#39;missing_count&#39;: 0, &#39;missing_percent&#39;: 0.0, &#39;unexpected_percent_total&#39;: 0.0, &#39;unexpected_percent_nonmissing&#39;: 0.0}
---
expectation_type: expect_column_values_to_not_be_null
kwargs: {&#39;column&#39;: &#39;varchar_column&#39;, &#39;batch_id&#39;: &#39;b431836ba46465a1106559d8e5ff2656&#39;}
success: True
result: {&#39;element_count&#39;: 8, &#39;unexpected_count&#39;: 0, &#39;unexpected_percent&#39;: 0.0, &#39;partial_unexpected_list&#39;: []}
---
expectation_type: expect_column_values_to_be_in_set
kwargs: {&#39;column&#39;: &#39;varchar_column&#39;, &#39;value_set&#39;: [&#39;xxxx&#39;, &#39;yyyy&#39;], &#39;batch_id&#39;: &#39;b431836ba46465a1106559d8e5ff2656&#39;}
success: True
result: {&#39;element_count&#39;: 8, &#39;unexpected_count&#39;: 0, &#39;unexpected_percent&#39;: 0.0, &#39;partial_unexpected_list&#39;: [], &#39;missing_count&#39;: 0, &#39;missing_percent&#39;: 0.0, &#39;unexpected_percent_total&#39;: 0.0, &#39;unexpected_percent_nonmissing&#39;: 0.0}
</code></pre><p>è©¦ã—ã«ä»¥ä¸‹ã®è¡Œã‚’è¿½åŠ ã—ã¦ã€ã€2. columnã€Œint_columnã€ã¯0~7ã®valueã§ã‚ã‚‹ã€‚ã€ã«åã™ã‚‹ã‚ˆã†ã«ã—ã¦ã¿ã‚‹ã€‚</p><ul><li>DDL</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> sample_poyo <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>9</span>, <span style=color:#e6db74>&#39;xxxx&#39;</span>, <span style=color:#e6db74>&#39;zzzz&#39;</span>);
</span></span></code></pre></div><ul><li>ãƒ‡ãƒ¼ã‚¿å†…å®¹</li></ul><pre tabindex=0><code> int_column | varchar_column | varchar_column2 
------------+----------------+-----------------
         0 | xxxx           | zzzz
         1 | xxxx           | zzzz
         2 | xxxx           | zzzz
         3 | xxxx           | zzzz
         4 | yyyy           | zzzz
         5 | yyyy           | zzzz
         6 | yyyy           | zzzz
         7 | yyyy           | zzzz
         9 | yyyy           | zzzz
</code></pre><p>ãã†ã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«çµæœãŒå¤‰ã‚ã‚‹ã€‚æ¤œè¨¼å¯¾è±¡ï¼™è¡Œ(element_count)ã®ã†ã¡1è¡Œ(unexpected_count)ãŒæœŸå¾…é€šã‚Šã§ã¯ãªã„ã€ã¨ã„ã†æ„å‘³ã ã€‚</p><pre tabindex=0><code>expectation_type: expect_column_values_to_be_between
kwargs: {&#39;column&#39;: &#39;int_column&#39;, &#39;max_value&#39;: 7, &#39;min_value&#39;: 0, &#39;batch_id&#39;: &#39;b431836ba46465a1106559d8e5ff2656&#39;}
success: False
result: {&#39;element_count&#39;: 9, &#39;unexpected_count&#39;: 1, &#39;unexpected_percent&#39;: 11.11111111111111, &#39;partial_unexpected_list&#39;: [9], &#39;missing_count&#39;: 0, &#39;missing_percent&#39;: 0.0, &#39;unexpected_percent_total&#39;: 11.11111111111111, &#39;unexpected_percent_nonmissing&#39;: 11.11111111111111}
</code></pre><h2 id=ã¤ã¾ã¥ã„ãŸãƒã‚¤ãƒ³ãƒˆ>ã¤ã¾ã¥ã„ãŸãƒã‚¤ãƒ³ãƒˆ<a hidden class=anchor aria-hidden=true href=#ã¤ã¾ã¥ã„ãŸãƒã‚¤ãƒ³ãƒˆ>#</a></h2><p>ä»Šå›æŒ‡å®šã—ãŸã‚ˆã†ã«ã€SqlAlchemyã‚’æ´»ç”¨ã—ãŸDataSourceã‚’ä½œæˆã—ãŸã„å ´åˆ(execution_engine.class_nameã«<code>SqlAlchemyExecutionEngine</code>ã‚’æŒ‡å®šã—ãŸDataSourceã®å ´åˆ)ã€create_engineã™ã‚‹æ™‚ã®å¼•æ•°ã¯ã€Œconnection_stringã€ã—ã‹ç¾åœ¨æ¸¡ã›ãªã„ã‚ˆã†ã§ã™ã€‚
<a href=https://github.com/great-expectations/great_expectations/issues/6226>https://github.com/great-expectations/great_expectations/issues/6226</a></p><h2 id=çµ‚ã‚ã‚Šã«>çµ‚ã‚ã‚Šã«<a hidden class=anchor aria-hidden=true href=#çµ‚ã‚ã‚Šã«>#</a></h2><p>GreatExpectationsã¨ã¯ä½•ã‹ã€ãŠã‚ˆã³Pythonã‚’ä½¿ã£ãŸä½¿ã„æ–¹ã«ã¤ã„ã¦èª¬æ˜ã—ã¦ã„ãã¾ã—ãŸã€‚
ä»Šå›ã¯ä½¿ã„ã¾ã›ã‚“ã§ã—ãŸãŒRuntimeBatchRequestã‚’ä½¿ãˆã°æ¤œè¨¼ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã‚’éƒ½åº¦æŸ”è»Ÿã«æŒ‡å®šã§ãã‚‹ã¨ã“ã‚ã€Queryã‚’æ›¸ã‹ãšã«Expectationã‚’å®šç¾©ã§ãã‚‹ã¨ã“ã‚ã€åŠã³ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã§ãã‚Œã‚‰ãŒç®¡ç†ã§ãã‚‹ã¨ã“ã‚ãŒå€‹äººçš„ã«è‰¯ã„ã‹ãªã¨æ€ã£ã¦ã„ã¾ã™ã€‚</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://467tn.com/tags/greatexpectations/>GreatExpectations</a></li><li><a href=https://467tn.com/tags/python/>Python</a></li></ul><nav class=paginav><a class=prev href=https://467tn.com/post/content7/><span class=title>Â« Prev</span><br><span>Airflowã®TaskFlowAPIã«ã¤ã„ã¦</span></a>
<a class=next href=https://467tn.com/post/content5/><span class=title>Next Â»</span><br><span>ãƒ‡ã‚¶ã‚¤ãƒ³å¤‰ãˆã¾ã—ãŸ</span></a></nav><br><hr><br><h3>Shares</h3><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Great Expectationsã«ã¤ã„ã¦èª¿ã¹ã¦ã¿ãŸ on twitter" href="https://twitter.com/intent/tweet/?text=Great%20Expectations%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6%e8%aa%bf%e3%81%b9%e3%81%a6%e3%81%bf%e3%81%9f&url=https%3a%2f%2f467tn.com%2fpost%2fcontent6%2f&hashtags=GreatExpectations%2cPython"><svg viewBox="0 0 512 512" height="30" width="30"><defs><style>.fill{fill:#3aa6b9}</style></defs><path class="fill" d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a></div></footer><h3>Comments</h3><script src=https://giscus.app/client.js data-repo=srn221B/blog data-repo-id=R_kgDOIBf-Xg data-category=Comments data-category-id=DIC_kwDOIBf-Xs4CTe7o data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-theme=https://giscus.app/themes/custom_example.css crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2024 <a href=https://467tn.com>-1.9517320122461623</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>